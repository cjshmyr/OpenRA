# Buildings provide a proximity condition for being nearby.
# Buildings have a condition when damaged.
# Buildings can be repaired by engineers.
^Building:
	ProximityExternalCondition:
		Condition: nearallybuilding
	GrantConditionOnDamageState@DAMAGED:
		Condition: damaged
		ValidDamageStates: Light, Medium, Heavy, Critical
	Targetable@REPAIR:
		RequiresCondition: damaged
		TargetTypes: Repair

# Infantry can see cloaked units.
# Allow infantry to auto-heal close enough to base buildings
# HACK: Allow infantry to capture neutral vehicles. Can be removed if we can garrison neutrals.
^Infantry:
	DetectCloaked:
		Range: 4c0
	ExternalCondition@NEARALLYBUILDING:
		Condition: nearallybuilding
	GrantCondition@INBASE:
		RequiresCondition: nearallybuilding
		Condition: inbase
	SelfHealing@DAMAGEDINBASE:
		Step: 500
		Delay: 25
		HealIfBelow: 100
		DamageCooldown: 125
		RequiresCondition: damaged && inbase
	WithDecoration@DAMAGEDINBASE:
		Image: pips
		Sequence: pip-heal
		ReferencePoint: Bottom, Right
		RequiresCondition: damaged && inbase
		BlinkInterval: 25
		BlinkPattern: Off, On
	CaptureManager:
	Captures@VEHICLES:
		CaptureTypes: Vehicle
		ConsumedByCapture: False

# Vehicles can see cloaked units.
# AI's purchased vehicles cost nothing.
# Vehicles have a condition when damaged.
# Vehicles can be repaired by engineers.
# HACK: Neutral vehicles can be captured. Can be removed if we can garrison neutrals.
# All vehicles provide no vision if empty.
^Vehicle:
	DetectCloaked:
		Range: 4c0
	Valued:
		Cost: 0
	GrantConditionOnDamageState@DAMAGED:
		Condition: damaged
		ValidDamageStates: Light, Medium, Heavy, Critical
	Targetable@REPAIR:
		RequiresCondition: damaged
		TargetTypes: Repair
	Cargo:
		LoadedCondition: occupied
	CaptureManager:
	Capturable:
		Types: Vehicle
		RequiresCondition: !occupied
		ValidStances: Neutral
	RevealsShroudMultiplier:
		Modifier: 0
		RequiresCondition: !occupied
